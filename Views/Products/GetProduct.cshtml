@using Rozetka.Data.Entity
@model Product
@{
    string? category = Context.Session.GetString("Category");
    string? childcategory = Context.Session.GetString("ChildCategory");
}
@{
    ViewData["Title"] = "Товар";
}

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href=".."><i class="bi bi-house"></i></a></li>
        <li class="breadcrumb-item"><a href="/Categories/GetChildCategories?category=@category">@category</a></li>
        <li class="breadcrumb-item"><a href="/Childcategories/GetProducts?childcategory=@childcategory">@childcategory</a></></li>
        <li class="breadcrumb-item active" aria-current="page">@Model.Brand.Title</li>
    </ol>
</nav>


<div class="row">
    <!-- Left Column: Product Images -->
    <div class="col-md-6">
       @*  <!-- Основное изображение продукта -->
        @if (Model.ProductImages != null && Model.ProductImages.Any())
        {
            <!-- Отображение первого изображения как основного -->
            <img src="data:image;base64,@Convert.ToBase64String(Model.ProductImages.First().ImageData)" class="img-fluid mb-3" alt="Main Product Image">

        }
        else
        {
            <!-- Если изображений нет, показываем плейсхолдер -->
            <img src="https://via.placeholder.com/450" class="img-fluid mb-3" alt="Main Product Image">
        }

        <!-- Галерея миниатюр (thumbs) -->
        <div class="d-flex">
            @if (Model.ProductImages != null && Model.ProductImages.Count() > 1)
            {
                <!-- Пропуск первого изображения, т.к. оно уже показано как основное -->
                @foreach (var image in Model.ProductImages.Skip(1))
                {
                    <img src="data:image;base64,@Convert.ToBase64String(image.ImageData)" class="img-thumbnail me-2" alt="Product Thumbnail" style="max-width: 100px;">
                }
            }
            else
            {
                <!-- Плейсхолдеры, если нет дополнительных изображений -->
                <img src="https://via.placeholder.com/100" class="img-thumbnail me-2" alt="Product Thumbnail">
                <img src="https://via.placeholder.com/100" class="img-thumbnail me-2" alt="Product Thumbnail">
                <img src="https://via.placeholder.com/100" class="img-thumbnail me-2" alt="Product Thumbnail">
                <img src="https://via.placeholder.com/100" class="img-thumbnail me-2" alt="Product Thumbnail">
            }
        </div> *@
        <div class="row">
            <div class="col-3">
                <!-- Галерея миниатюр (thumbs) -->
                <div class="grid gap-3">
                    @if (Model.ProductImages != null)
                    {
                        @foreach (var image in Model.ProductImages)
                        {
                            <div class="p-2 g-col-3">
                                <img src="data:image;base64,@Convert.ToBase64String(image.ImageData)" class="img-thumbnail me-2 thumbnail" alt="Product Thumbnail" style="max-width: 100px; cursor: pointer;">
                            </div>
                        }
                    }
                </div>
            </div>
            <div class="col-9">
                <!-- Основное изображение продукта -->
                <img id="main-image" src="data:image;base64,@Convert.ToBase64String(Model.ProductImages.FirstOrDefault()?.ImageData)" class="img-fluid mb-3" alt="Main Product Image">
            </div>  
            
        </div>
    </div>

    <!-- Right Column: Product Details -->
    <div class="col-md-6">
        <h4>@Model.ProductType.Title @Model.Brand.Title @Model.Title</h4>
        <div class="d-flex justify-content-between align-items-center mb-2">
            <p><i class="bi bi-star-fill rating"></i> 4.1 Рейтинг</p>
            <p>Артикул: @Model.Id</p>
        </div>
        <h5>Кольори:</h5>
        <div class="d-flex mb-3">
            <button class="btn btn-light me-2">Чорний</button>
            <button class="btn btn-light me-2">Коричневий</button>
        </div>

        <div class="border p-3 mb-3">
            <h4>Пропозиції</h4>
            <p>Чохол для навушників Marshall Major III - 499₴</p>
            <p>Подушки для навушників - 269₴</p>
        </div>

        <div class="row">
            <div class="col p-0">
                <h4 class="price">@Model.Price ₴</h4>
            </div>
            <div class="col-8">
                <button class="btn btn-purple btn-lg w-100">Додати до кошика</button>
            </div>
            <div class="col-1 p-0">
                <button class="btn btn-outline-purple btn-lg"><i class="bi bi-heart"></i> </button>
            </div>
        </div>
        <p>Доставка: Відправлення Новою Поштою | Отримати завтра до 16:00</p>
    </div>
</div>

<!-- Product Description and Characteristics -->
<div class="row mt-5">
    <div class="col-md-8">
        <h3>Опис товару</h3>
        <p>@Model.Description</p>
    </div>
    <div class="col-md-4">
        <h3>Характеристики</h3>
        <ul class="list-unstyled">
            <li><strong>Тип навушників:</strong> Накладні</li>
            <li><strong>Тип підключення:</strong> Бездротові</li>
            <li><strong>Інтерфейс підключення:</strong> 3.5 мм</li>
            <li><strong>Колір:</strong> Чорний</li>
            <!-- Add more characteristics as needed -->
        </ul>
    </div>
</div>

<!-- Reviews Section -->
<div class="row mt-5">
    <div class="col-md-12">
        <h3>Відгуки (11)</h3>
        <div class="row">
            <div class="col-md-4">
                <div class="border p-3 mb-3">
                    <h5>Руслан Павлов <span class="rating"><i class="bi bi-star-fill"></i> 5</span></h5>
                    <p>Чудові навушники! Якість звуку на висоті.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="border p-3 mb-3">
                    <h5>Яна Дмитрієва <span class="rating"><i class="bi bi-star-fill"></i> 4.5</span></h5>
                    <p>Класно виглядають і зручно сидять на голові!</p>
                </div>
            </div>
            <!-- Add more reviews -->
        </div>
    </div>
</div>

<!-- Similar Products Section -->
<div class="row mt-5">
    <div class="col-md-12">
        <h3>Схожі товари</h3>
        <div class="row">
            <div class="col-md-2">
                <img src="https://via.placeholder.com/150" class="img-fluid" alt="Product Image">
                <p>Marshall Major III - 3200₴</p>
            </div>
            <div class="col-md-2">
                <img src="https://via.placeholder.com/150" class="img-fluid" alt="Product Image">
                <p>Marshall Major II - 3599₴</p>
            </div>
            <!-- Add more products -->
        </div>
    </div>
</div>





<!-- Кнопка для відкриття кошика -->
@* <div class="product-item">        
    <!-- Кнопка для додавання товару в кошик -->
    <button class="btn btn-primary"
            onclick="addToCartAndOpenSidebar('@Model.Id', '@Model.Title', '@Model.ProductImages', '@Model.Price')">
        <i class="bi bi-cart-plus"></i> Pass to Cart
    </button>
</div> *@

@* <div class="mt-3">
    <a asp-controller="Cart" asp-action="AddToCart" asp-route-id="@Model.Id" class="btn btn-primary">
        <i class="bi bi-cart-plus"></i> Додати в кошик
    </a>
</div> *@






<script>
    // Добавление обработчика события 'click' на миниатюры
    document.querySelectorAll('.thumbnail').forEach(img => {
        img.addEventListener('click', function () {
            const mainImage = document.getElementById('main-image');
            // Обновление основного изображения
            mainImage.src = this.src;
            // Опционально: добавление рамки на активное изображение
            document.querySelectorAll('.thumbnail').forEach(thumb => thumb.style.border = 'none');
            this.style.border = '2px solid #9C12FF';
        });
    });
</script>